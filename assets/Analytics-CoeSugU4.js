import{aJ as je,r,j as e,aK as H,aL as Q,aM as X,aN as pe,a9 as fe,ak as D,aO as ge,aP as P,aQ as ye}from"./react-ngz0KEri.js";import{g as F,u as Ne,a as be,b as ve,S as we,c as Ce,d as ke,e as Me,f as N,C as x,i as h,j as u,h as j,B as De}from"./index-q3cQ66e3.js";import{B as E}from"./button-BhbNX3hy.js";import{R as U,P as W,I as V,J as z,T as Y,L as J,K as Ee,M as Te,N as $e,O as Z,S as G}from"./vendor-CfMdQmI6.js";const Se=je,q=r.forwardRef(({className:p,...f},y)=>e.jsx(H,{ref:y,className:F("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",p),...f}));q.displayName=H.displayName;const $=r.forwardRef(({className:p,...f},y)=>e.jsx(Q,{ref:y,className:F("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",p),...f}));$.displayName=Q.displayName;const S=r.forwardRef(({className:p,...f},y)=>e.jsx(X,{ref:y,className:F("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",p),...f}));S.displayName=X.displayName;const Re=({expenses:p,income:f,loading:y=!1})=>{const{t:n}=Ne(),{formatAmount:ee,currency:se}=be();ve();const te={USD:"$",EUR:"â‚¬",GBP:"Â£",ZMW:"ZK"},ae=s=>te[s]||s,[b,ne]=r.useState("all"),[O,le]=r.useState("symbol"),[g,R]=r.useState("monthly"),re=s=>{const t=new Date;switch(s){case"daily":return G(t,1);case"week":return G(t,7);case"month":return Z(t,1);case"3months":return Z(t,3);case"year":return $e(t);case"all":default:return new Date(0)}},T=r.useMemo(()=>re(b),[b]),o=r.useMemo(()=>{const s=new Date;return f.filter(t=>{const a=new Date(t.date);return a>=T&&a<=s})},[f,T]),d=r.useMemo(()=>{const s=new Date;return p.filter(t=>{const a=new Date(t.date);return a>=T&&a<=s})},[p,T]),v=r.useMemo(()=>o.reduce((s,t)=>s+t.amount,0),[o]),w=r.useMemo(()=>d.reduce((s,t)=>s+t.amount,0),[d]),L=s=>s.reduce((t,a)=>(t[a.category]=(t[a.category]||0)+a.amount,t),{}),ce=r.useMemo(()=>L(d),[d]),ie=r.useMemo(()=>L(o),[o]),C=Object.entries(ce).sort(([,s],[,t])=>t-s),k=Object.entries(ie).sort(([,s],[,t])=>t-s),oe=r.useMemo(()=>[...o,...d].reduce((s,t)=>{const a=t.date.slice(0,7);return s[a]||(s[a]={income:0,expenses:0}),t.type==="expense"?s[a].expenses+=t.amount:s[a].income+=t.amount,s},{}),[o,d]),de=r.useMemo(()=>{const s=t=>{const a=new Date(t),l=new Date(a.getFullYear(),0,4),c=Math.floor((a.getTime()-l.getTime())/(24*60*60*1e3))+1,M=Math.ceil(c/7);return`${a.getFullYear()}-W${M.toString().padStart(2,"0")}`};return[...o,...d].reduce((t,a)=>{const l=s(a.date);return t[l]||(t[l]={income:0,expenses:0}),a.type==="expense"?t[l].expenses+=a.amount:t[l].income+=a.amount,t},{})},[o,d]),I=Object.entries(oe).sort(([s],[t])=>s.localeCompare(t)).slice(-6),B=Object.entries(de).sort(([s],[t])=>s.localeCompare(t)).slice(-12),_=["#FF6B6B","#FF9F43","#F7B801","#6BCB77","#4D96FF"],A=["#008000","#1E90FF","#FFD700","#FF69B4","#FF8C00"],i=s=>O==="symbol"?ee(s):`${s.toFixed(2)} ${ae(se)}`,me=()=>{let s="data:text/csv;charset=utf-8,";g==="monthly"?(s+=`Month,Income,Expenses
`,I.forEach(([l,c])=>{s+=`${l},${c.income},${c.expenses}
`})):(s+=`Week,Income,Expenses
`,B.forEach(([l,c])=>{s+=`${l},${c.income},${c.expenses}
`}));const t=encodeURI(s),a=document.createElement("a");a.href=t,a.download=`analytics_export_${g}_${b}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a)},K=[{value:"Cash",label:"Cash",icon:"ðŸ’µ"},{value:"Bank",label:"Bank",icon:"ðŸ¦"},{value:"Credit Card",label:"Credit Card",icon:"ðŸ’³"},{value:"Debit Card",label:"Debit Card",icon:"ðŸ§"},{value:"Mobile Money",label:"Mobile Money",icon:"ðŸ“±"},{value:"Savings",label:"Savings",icon:"ðŸ’°"}],m=r.useMemo(()=>K.map(s=>{const t=o.filter(c=>c.account===s.value).reduce((c,M)=>c+M.amount,0),a=d.filter(c=>c.account===s.value).reduce((c,M)=>c+M.amount,0),l=t-a;return{...s,totalIncome:t,totalExpenses:a,netBalance:l}}),[K,o,d]),xe=r.useMemo(()=>Math.max(...m.map(s=>s.totalIncome),0),[m]),he=r.useMemo(()=>Math.max(...m.map(s=>s.totalExpenses),0),[m]);r.useMemo(()=>Math.max(...m.map(s=>Math.abs(s.netBalance)),0),[m]);const ue=()=>{let s="data:text/csv;charset=utf-8,";s+=`Account,Net Balance,Money In,Money Out
`,m.forEach(l=>{s+=`${l.label},${l.netBalance},${l.totalIncome},${l.totalExpenses}
`});const t=encodeURI(s),a=document.createElement("a");a.href=t,a.download=`account_balances_export_${b}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a)};return y?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(pe,{className:"animate-spin w-10 h-10 text-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[e.jsx("h3",{className:"text-lg font-semibold dark:text-gray-200",children:n("analytics")||"Analytics"}),e.jsxs(we,{value:b,onValueChange:s=>ne(s),children:[e.jsx(Ce,{className:"w-40",children:e.jsx(ke,{placeholder:n("selectTimeframe")})}),e.jsxs(Me,{children:[e.jsx(N,{value:"daily",children:n("daily")}),e.jsx(N,{value:"week",children:n("lastWeek")}),e.jsx(N,{value:"month",children:n("lastMonth")}),e.jsx(N,{value:"3months",children:n("last3Months")}),e.jsx(N,{value:"year",children:n("lastYear")}),e.jsx(N,{value:"all",children:n("allTime")})]})]}),e.jsxs(E,{variant:"outline",size:"sm",onClick:()=>le(s=>s==="symbol"?"code":"symbol"),title:n("toggleCurrencyFormat")||"Toggle currency format",children:[e.jsx(fe,{className:"mr-2"}),n(O==="symbol"?"symbol":"code")]})]}),e.jsxs(Se,{defaultValue:"charts",children:[e.jsxs(q,{className:"grid grid-cols-2 md:grid-cols-3 w-full mx-auto",children:[e.jsx($,{value:"charts",children:"Charts"}),e.jsx($,{value:"trends",children:"Trends"}),e.jsx($,{value:"accounts",children:"Accounts"})]}),e.jsxs(S,{value:"charts",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs(x,{className:"shadow-income bg-gradient-to-br from-income-light to-white dark:from-income-dark dark:to-background",children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium text-foreground dark:text-black",children:n("totalIncome")}),e.jsx(D,{className:"h-4 w-4 text-income"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold text-income",children:i(v)}),e.jsxs("p",{className:"text-xs text-muted-foreground dark:text-black mt-1",children:[o.length," ",n("transactions")]})]})]}),e.jsxs(x,{className:"shadow-expense bg-gradient-to-br from-expense-light to-white dark:from-expense-dark dark:to-background",children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium text-foreground dark:text-black",children:n("totalExpenses")}),e.jsx(ge,{className:"h-4 w-4 text-expense"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold text-expense",children:i(w)}),e.jsxs("p",{className:"text-xs text-muted-foreground dark:text-black mt-1",children:[d.length," ",n("transactions")]})]})]}),e.jsxs(x,{className:"shadow-large bg-gradient-primary text-primary-foreground",children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:n("netBalance")}),e.jsx(D,{className:"h-4 w-4"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i(v-w)}),e.jsx("p",{className:"text-xs opacity-90 mt-1",children:v-w>=0?n("surplus"):n("deficit")})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-expense"}),n("expenses")]})}),e.jsx(j,{children:C.length>0?e.jsx(U,{width:"100%",height:300,children:e.jsxs(W,{children:[e.jsx(V,{data:C.map(([s,t])=>({name:s,value:t})),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:({name:s,value:t})=>`${s}: ${i(t)}`,children:C.map((s,t)=>e.jsx(z,{fill:_[t%_.length]},t))}),e.jsx(Y,{formatter:s=>typeof s=="number"?i(s):String(s)}),e.jsx(J,{})]})}):e.jsx("p",{className:"text-center text-muted-foreground py-4",children:n("noExpenseData")||"No expense data available"})})]}),e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5 text-income"}),n("income")]})}),e.jsx(j,{children:k.length>0?e.jsx(U,{width:"100%",height:300,children:e.jsxs(W,{children:[e.jsx(V,{data:k.map(([s,t])=>({name:s,value:t})),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:({name:s,value:t})=>`${s}: ${i(t)}`,children:k.map((s,t)=>e.jsx(z,{fill:A[t%A.length]},t))}),e.jsx(Y,{formatter:s=>typeof s=="number"?i(s):String(s)}),e.jsx(J,{})]})}):e.jsx("p",{className:"text-center text-muted-foreground py-4",children:n("noIncomeData")||"No income data available"})})]})]})]}),e.jsxs(S,{value:"trends",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(E,{size:"sm",variant:g==="monthly"?"default":"outline",onClick:()=>R("monthly"),children:n("monthly")}),e.jsx(E,{size:"sm",variant:g==="weekly"?"default":"outline",onClick:()=>R("weekly"),children:n("weekly")})]}),e.jsx(E,{size:"sm",variant:"outline",onClick:me,children:n("exportData")||"Export Data"})]}),e.jsxs(x,{className:"shadow-soft",children:[e.jsx(h,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5 text-income"}),n("topIncomeCategories")||"Top Income Categories"]})}),e.jsx(j,{children:k.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:k.slice(0,5).map(([s,t])=>{const a=v>0?t/v*100:0;return e.jsxs("div",{className:"space-y-2 border p-3 rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:s}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-bold text-income",children:i(t)}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[a.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"w-full bg-secondary rounded-full h-2",children:e.jsx("div",{className:"bg-income rounded-full h-2 transition-all duration-500",style:{width:`${a}%`}})})]},s)})}):e.jsx("p",{className:"text-muted-foreground text-center py-4",children:n("noIncomeData")||"No income data available"})})]}),e.jsxs(x,{className:"shadow-soft mt-6",children:[e.jsx(h,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-expense"}),n("topExpenseCategories")||"Top Expense Categories"]})}),e.jsx(j,{children:C.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:C.slice(0,5).map(([s,t])=>{const a=w>0?t/w*100:0;return e.jsxs("div",{className:"space-y-2 border p-3 rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:s}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-bold text-expense",children:i(t)}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[a.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"w-full bg-secondary rounded-full h-2",children:e.jsx("div",{className:"bg-expense rounded-full h-2 transition-all duration-500",style:{width:`${a}%`}})})]},s)})}):e.jsx("p",{className:"text-muted-foreground text-center py-4",children:n("noExpenseData")||"No expense data available"})})]}),(g==="monthly"?I:B).length>0?e.jsxs(x,{className:"shadow-soft mt-6",children:[e.jsx(h,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5"}),n(g==="monthly"?"monthlyTrends":"weeklyTrends")]})}),e.jsx(j,{children:e.jsx("div",{className:"space-y-4",children:(g==="monthly"?I:B).map(([s,t])=>{const a=t.income-t.expenses,l=Math.max(t.income,t.expenses),c=g==="monthly"?new Date(s+"-01").toLocaleDateString(n("locale")||"en-US",{year:"numeric",month:"long"}):`${s} (${Ee(Te(new Date),"MMM d")})`;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:c}),e.jsxs(De,{variant:a>=0?"secondary":"destructive",children:[a>=0?"+":"",i(Math.abs(a))]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 text-xs text-income",children:"Income"}),e.jsx("div",{className:"flex-1 bg-secondary rounded-full h-2",children:e.jsx("div",{className:"bg-income rounded-full h-2 transition-all duration-500",style:{width:l>0?`${t.income/l*100}%`:"0%"}})}),e.jsx("div",{className:"w-20 text-xs text-right",children:i(t.income)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 text-xs text-expense",children:"Expenses"}),e.jsx("div",{className:"flex-1 bg-secondary rounded-full h-2",children:e.jsx("div",{className:"bg-expense rounded-full h-2 transition-all duration-500",style:{width:l>0?`${t.expenses/l*100}%`:"0%"}})}),e.jsx("div",{className:"w-20 text-xs text-right",children:i(t.expenses)})]})]})]},s)})})})]}):e.jsx("p",{className:"text-center text-muted-foreground py-4",children:n("noTrendData")||"No trend data available"})]}),e.jsx(S,{value:"accounts",children:e.jsxs(x,{className:"shadow-soft",children:[e.jsxs(h,{className:"flex flex-row items-center justify-between",children:[e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5"}),"Account Balances"]}),e.jsx(E,{size:"sm",variant:"outline",onClick:ue,children:n("exportData")||"Export Data"})]}),e.jsx(j,{children:m.length>0?e.jsx("div",{className:"space-y-4",children:m.map(s=>{const t=s.netBalance,a=t>=0,l=a?"text-income":"text-expense";return e.jsxs("div",{className:"space-y-4 border p-4 rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:s.icon}),e.jsx("span",{className:"text-lg font-semibold",children:s.label})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-xl font-bold ${l}`,children:i(t)}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:a?"Surplus":"Deficit"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-24 text-sm text-income",children:"Money In"}),e.jsx("div",{className:"flex-1 h-2 bg-secondary rounded-full",children:e.jsx("div",{className:"h-full bg-income rounded-full transition-all duration-500",style:{width:`${s.totalIncome/xe*100}%`}})}),e.jsx("span",{className:"w-24 text-sm text-right text-income",children:i(s.totalIncome)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-24 text-sm text-expense",children:"Money Out"}),e.jsx("div",{className:"flex-1 h-2 bg-secondary rounded-full",children:e.jsx("div",{className:"h-full bg-expense rounded-full transition-all duration-500",style:{width:`${s.totalExpenses/he*100}%`}})}),e.jsx("span",{className:"w-24 text-sm text-right text-expense",children:i(s.totalExpenses)})]})]})]},s.value)})}):e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No account data available"})})]})})]})]})};export{Re as default};

import{r as x,a as O,j as e,z as g,O as p,Q as f,V as M,A as y,S as v,c as N,d as w,e as C,f as l,X as W,U as m,W as Y}from"./index-CFYcj9ZF.js";import{I as P}from"./input-DQX9Yz5e.js";import{B as Z}from"./button-DLo5zwi1.js";import{ExpenseList as z}from"./ExpenseList-CxWkakRP.js";import{IncomeList as H}from"./IncomeList-Bm9IFtpe.js";import"./trash-2-D-X0bAdQ.js";const J=({expenses:u,income:j,onDeleteExpense:I,onDeleteIncome:k})=>{const[r,S]=x.useState(""),[n,T]=x.useState("all"),[c,F]=x.useState("all"),[i,D]=x.useState("all"),{currency:E}=O(),A=x.useMemo(()=>{const s=new Set([...u.map(a=>a.category),...j.map(a=>a.category)]);return Array.from(s).sort()},[u,j]),o=x.useMemo(()=>{let s=[...u,...j];if(r){const a=r.toLowerCase();s=s.filter(t=>t.description.toLowerCase().includes(a)||t.category.toLowerCase().includes(a)||t.account&&t.account.toLowerCase().includes(a))}if(n!=="all"&&(s=s.filter(a=>a.category===n)),c!=="all"&&(s=s.filter(a=>a.type===c)),i!=="all"){const a=new Date,t=new Date;switch(i){case"week":t.setDate(a.getDate()-7);break;case"month":t.setMonth(a.getMonth()-1);break;case"3months":t.setMonth(a.getMonth()-3);break;case"year":t.setFullYear(a.getFullYear()-1);break}s=s.filter(B=>new Date(B.date)>=t)}return s.sort((a,t)=>new Date(t.date).getTime()-new Date(a.date).getTime())},[u,j,r,n,c,i]),d=o.filter(s=>s.type==="expense"),h=o.filter(s=>s.type==="income"),V=()=>{S(""),T("all"),F("all"),D("all")},b=r!==""||n!=="all"||c!=="all"||i!=="all",L=s=>new Intl.NumberFormat("en-ZM",{style:"currency",currency:E||"ZMW",minimumFractionDigits:2}).format(s);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(g,{className:"shadow-soft",children:[e.jsx(p,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),"Search & Filter Transactions"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(P,{placeholder:"Search by description, category, or account...",value:r,onChange:s=>S(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(v,{value:c,onValueChange:F,children:[e.jsx(N,{children:e.jsx(w,{placeholder:"Transaction Type"})}),e.jsxs(C,{children:[e.jsx(l,{value:"all",children:"All Types"}),e.jsx(l,{value:"income",children:"Income Only"}),e.jsx(l,{value:"expense",children:"Expenses Only"})]})]}),e.jsxs(v,{value:n,onValueChange:T,children:[e.jsx(N,{children:e.jsx(w,{placeholder:"Category"})}),e.jsxs(C,{children:[e.jsx(l,{value:"all",children:"All Categories"}),A.map(s=>e.jsx(l,{value:s,children:s},s))]})]}),e.jsxs(v,{value:i,onValueChange:D,children:[e.jsx(N,{children:e.jsx(w,{placeholder:"Time Period"})}),e.jsxs(C,{children:[e.jsx(l,{value:"all",children:"All Time"}),e.jsx(l,{value:"week",children:"Last Week"}),e.jsx(l,{value:"month",children:"Last Month"}),e.jsx(l,{value:"3months",children:"Last 3 Months"}),e.jsx(l,{value:"year",children:"Last Year"})]})]}),e.jsxs(Z,{variant:"outline",onClick:V,disabled:!b,className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4"}),"Clear Filters"]})]}),b&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[r&&e.jsxs(m,{variant:"secondary",children:['Search: "',r,'"']}),c!=="all"&&e.jsxs(m,{variant:"secondary",children:["Type: ",c]}),n!=="all"&&e.jsxs(m,{variant:"secondary",children:["Category: ",n]}),i!=="all"&&e.jsxs(m,{variant:"secondary",children:["Period: ",i]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Found ",o.length," transaction",o.length!==1?"s":"","(",h.length," income, ",d.length," expenses)"]}),o.length>0&&e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[h.length>0&&e.jsxs(m,{variant:"secondary",className:"text-income",children:["Income: ",L(h.reduce((s,a)=>s+(a.amount||0),0))]}),d.length>0&&e.jsxs(m,{variant:"secondary",className:"text-expense",children:["Expenses: ",L(d.reduce((s,a)=>s+(a.amount||0),0))]})]})]}),o.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(Y,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"No transactions found"}),e.jsx("p",{children:"Try adjusting your search criteria or filters"})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[h.length>0&&e.jsxs(g,{className:"shadow-soft",children:[e.jsx(p,{children:e.jsxs(f,{className:"text-income",children:["Income (",h.length,")"]})}),e.jsx(y,{children:e.jsx(H,{income:h,onDelete:k})})]}),d.length>0&&e.jsxs(g,{className:"shadow-soft",children:[e.jsx(p,{children:e.jsxs(f,{className:"text-expense",children:["Expenses (",d.length,")"]})}),e.jsx(y,{children:e.jsx(z,{expenses:d,onDelete:I})})]})]})]})};export{J as SearchExpenses};

import{at as G,r as N,j as t,au as H,aj as K}from"./react-ngz0KEri.js";import{B as w}from"./button-BhbNX3hy.js";import{I as S}from"./input-DHhPsQaB.js";import{L as u}from"./label-BMo0q7YE.js";import{T as Q}from"./textarea-CvFosHyQ.js";import{u as U,a as X,b as Z,S as T,c as A,d as E,e as k,f as O}from"./index-q3cQ66e3.js";import"./vendor-CfMdQmI6.js";const _=G((f,n)=>({transfers:JSON.parse(localStorage.getItem("transfers")||"[]"),addTransfer:l=>{const c=[...n().transfers];if(c.push(l),l.repeat&&l.repeatStart&&l.repeatEnd){const i=new Date(l.repeatStart),v=new Date(l.repeatEnd);let a=new Date(i);const g=()=>{switch(l.repeat){case"Daily":a.setDate(a.getDate()+1);break;case"Weekly":a.setDate(a.getDate()+7);break;case"Monthly":a.setMonth(a.getMonth()+1);break;case"Yearly":a.setFullYear(a.getFullYear()+1);break}};for(;a<=v;){const p=a.toISOString().split("T")[0];p!==l.date&&c.push({...l,date:p}),g()}}f({transfers:c}),localStorage.setItem("transfers",JSON.stringify(c))},deleteTransfer:l=>{const c=[...n().transfers];c.splice(l,1),f({transfers:c}),localStorage.setItem("transfers",JSON.stringify(c))}})),ce=({onSubmit:f})=>{var R;const{t:n}=U(),{currencies:l,currency:c}=X(),{toast:i}=Z(),v=_(e=>e.addTransfer),[a,g]=N.useState({date:new Date().toISOString().split("T")[0],amount:0,fromAccount:"",toAccount:"",description:"",repeat:"One-time",repeatStart:"",repeatEnd:""}),[p,I]=N.useState(!1),[h,d]=N.useState(""),C=[{value:"Cash",label:"Cash",icon:"💵"},{value:"Bank",label:"Bank",icon:"🏦"},{value:"Credit Card",label:"Credit Card",icon:"💳"},{value:"Debit Card",label:"Debit Card",icon:"🏧"},{value:"Mobile Money",label:"Mobile Money",icon:"📱"}],F=[{value:"One-time",label:"One-time"},{value:"Daily",label:"Daily"},{value:"Weekly",label:"Weekly"},{value:"Monthly",label:"Monthly"},{value:"Yearly",label:"Yearly"}],o=(e,r)=>{g(s=>({...s,[e]:r}))},Y=(e,r)=>{const s=new Date(e);switch(r){case"Daily":s.setDate(s.getDate()+1);break;case"Weekly":s.setDate(s.getDate()+7);break;case"Monthly":s.setMonth(s.getMonth()+1);break;case"Yearly":s.setFullYear(s.getFullYear()+1);break}return s},L=e=>{const r=h.slice(-1),s=["+","-","*","/"];s.includes(e)&&s.includes(r)||e==="."&&h.includes(".")&&(h.split(/[-+*/]/).pop()||"").includes(".")||d(m=>m+e)},B=()=>{try{const e=new Function("return "+h)(),r=parseFloat(e.toFixed(2));o("amount",r),d(""),I(!1)}catch{i({title:n("Error"),description:n("Invalid calculation")||"Invalid calculation",variant:"destructive"}),d("")}},V=()=>{d(""),o("amount",0)},W=()=>{d(e=>e.slice(0,-1))},z=e=>{const r=e.target.value;d(r),o("amount",parseFloat(r))},J=e=>{e.preventDefault();const{amount:r,fromAccount:s,toAccount:m,description:D,repeat:x,repeatStart:j,repeatEnd:b,date:P}=a;if(!r||!s||!m||!D){i({title:n("Error"),description:n("Please fill in all required fields"),variant:"destructive"});return}if(r<=0){i({title:n("Error"),description:n("Amount must be greater than 0"),variant:"destructive"});return}if(s===m){i({title:n("Error"),description:n("Cannot transfer to the same account"),variant:"destructive"});return}if(x!=="One-time"){if(!j||!b){i({title:n("Error"),description:n("Please select repeat start and end dates"),variant:"destructive"});return}if(b<j){i({title:n("Error"),description:n("Repeat end date cannot be before start date"),variant:"destructive"});return}let y=new Date(j);const $=new Date(b);for(;y<=$;)v({date:y.toISOString().split("T")[0],amount:r,fromAccount:s,toAccount:m,description:D,repeat:x,repeatStart:j,repeatEnd:b}),y=Y(y,x)}else v({date:P,amount:r,fromAccount:s,toAccount:m,description:D,repeat:x});g({date:new Date().toISOString().split("T")[0],amount:0,fromAccount:"",toAccount:"",description:"",repeat:"One-time",repeatStart:"",repeatEnd:""}),d(""),i({title:n("Success"),description:n("Transfer successful!"),variant:"default"}),f(a)},M=e=>{const r=C.find(s=>s.value===e);return r?`${r.icon} ${r.label}`:n("Select account")},q=e=>{const r=F.find(s=>s.value===e);return r?r.label:n("Repeat frequency")};return t.jsxs("form",{onSubmit:J,className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(u,{children:n("Date")}),t.jsx(S,{type:"date",value:a.date,onChange:e=>o("date",e.target.value),className:"shadow-soft"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs(u,{children:[n("Amount")," (",(R=l[c])==null?void 0:R.symbol,") *"]}),t.jsxs("div",{className:"flex relative",children:[t.jsx(S,{type:"text",value:h||(a.amount>0?a.amount:""),onChange:z,placeholder:"0.00",className:"shadow-soft pr-10 flex-1"}),t.jsx(w,{type:"button",variant:"ghost",size:"sm",onClick:()=>{I(!p),!p&&a.amount>0?d(a.amount.toString()):!p&&a.amount===0&&d("")},className:"absolute right-0 top-1/2 -translate-y-1/2",children:t.jsx(H,{className:"h-4 w-4 text-muted-foreground"})})]}),p&&t.jsxs("div",{className:"inline top-16 right-10 w-64 p-2 rounded-lg shadow-md bg-background text-foreground z-50",children:[t.jsx("div",{className:"mb-2 text-right font-mono select-One-time border-b-2 pb-1 border-gray-200",children:h||a.amount||"0"}),t.jsx("div",{className:"grid grid-cols-4 gap-1",children:["7","8","9","/","4","5","6","*","1","2","3","-","C","0","DEL","+",".","="].map(e=>t.jsx(w,{type:"button",variant:"outline",size:"sm",onClick:()=>{e==="="?B():e==="C"?V():e==="DEL"?W():L(e)},children:e},e))})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(u,{children:"Transfer From Account"}),t.jsxs(T,{value:a.fromAccount,onValueChange:e=>o("fromAccount",e),children:[t.jsx(A,{className:"shadow-soft",children:t.jsx(E,{placeholder:"Select Account",children:M(a.fromAccount)})}),t.jsx(k,{children:C.map(e=>t.jsxs(O,{value:e.value,children:[e.icon," ",e.label]},e.value))})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(u,{children:"Transfer To Account"}),t.jsxs(T,{value:a.toAccount,onValueChange:e=>o("toAccount",e),children:[t.jsx(A,{className:"shadow-soft",children:t.jsx(E,{placeholder:"Select Account",children:M(a.toAccount)})}),t.jsx(k,{children:C.map(e=>t.jsxs(O,{value:e.value,children:[e.icon," ",e.label]},e.value))})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(u,{children:"Repeat"}),t.jsxs(T,{value:a.repeat,onValueChange:e=>o("repeat",e),children:[t.jsx(A,{className:"shadow-soft",children:t.jsx(E,{children:q(a.repeat)})}),t.jsx(k,{children:F.map(e=>t.jsx(O,{value:e.value,children:e.label},e.value))})]})]}),a.repeat!=="One-time"&&t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(u,{children:"Repeat Start"}),t.jsx(S,{type:"date",value:a.repeatStart,onChange:e=>o("repeatStart",e.target.value),className:"shadow-soft"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(u,{children:"Repeat End"}),t.jsx(S,{type:"date",value:a.repeatEnd,onChange:e=>o("repeatEnd",e.target.value),className:"shadow-soft"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(u,{children:"Description"}),t.jsx(Q,{value:a.description,onChange:e=>o("description",e.target.value),placeholder:"Reason for transfer",className:"shadow-soft",rows:3})]}),t.jsxs(w,{type:"submit",variant:"default",className:"w-full",children:[t.jsx(K,{className:"h-4 w-4 mr-2"}),"Transfer Funds"]})]})};export{ce as TransferForm};
